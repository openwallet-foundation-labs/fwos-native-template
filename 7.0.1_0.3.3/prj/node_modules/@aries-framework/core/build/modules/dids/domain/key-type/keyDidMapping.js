"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getKeyDidMappingByVerificationMethod = exports.getKeyDidMappingByKeyType = void 0;
const crypto_1 = require("../../../../crypto");
const bls12381g1_1 = require("./bls12381g1");
const bls12381g1g2_1 = require("./bls12381g1g2");
const bls12381g2_1 = require("./bls12381g2");
const ed25519_1 = require("./ed25519");
const x25519_1 = require("./x25519");
// TODO: Maybe we should make this dynamically?
const keyDidMapping = {
    [crypto_1.KeyType.Ed25519]: ed25519_1.keyDidEd25519,
    [crypto_1.KeyType.X25519]: x25519_1.keyDidX25519,
    [crypto_1.KeyType.Bls12381g1]: bls12381g1_1.keyDidBls12381g1,
    [crypto_1.KeyType.Bls12381g2]: bls12381g2_1.keyDidBls12381g2,
    [crypto_1.KeyType.Bls12381g1g2]: bls12381g1g2_1.keyDidBls12381g1g2,
};
/**
 * Dynamically creates a mapping from verification method key type to the key Did interface
 * for all key types.
 *
 * {
 *    "Ed25519VerificationKey2018": KeyDidMapping
 * }
 */
const verificationMethodKeyDidMapping = Object.values(crypto_1.KeyType).reduce((mapping, keyType) => {
    const supported = keyDidMapping[keyType].supportedVerificationMethodTypes.reduce((accumulator, vMethodKeyType) => (Object.assign(Object.assign({}, accumulator), { [vMethodKeyType]: keyDidMapping[keyType] })), {});
    return Object.assign(Object.assign({}, mapping), supported);
}, {});
function getKeyDidMappingByKeyType(keyType) {
    const keyDid = keyDidMapping[keyType];
    if (!keyDid) {
        throw new Error(`Unsupported key did from key type '${keyType}'`);
    }
    return keyDid;
}
exports.getKeyDidMappingByKeyType = getKeyDidMappingByKeyType;
function getKeyDidMappingByVerificationMethod(verificationMethod) {
    const keyDid = verificationMethodKeyDidMapping[verificationMethod.type];
    if (!keyDid) {
        throw new Error(`Unsupported key did from verification method type '${verificationMethod.type}'`);
    }
    return keyDid;
}
exports.getKeyDidMappingByVerificationMethod = getKeyDidMappingByVerificationMethod;
//# sourceMappingURL=keyDidMapping.js.map